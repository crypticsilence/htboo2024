
Grabbed info about the single binary in the zip file:

``` shell
└──╼ $file link ; echo ; pwn checksec link ; strings link > strings.txt ; less strings.txt
link: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=998c1a511ccf0a80eec3ed30dab3331ce2cf9f7f, for GNU/Linux 4.4.0, stripped

[*] '/home/amplex/htb/_ctf/htboo2024/rev_linkhands/link'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
```

Ran it thru dogbolt.org and looked for anything interesting, hexrays IDA shows the following decompiled output:

``` c

FILE **sub_401160()
{
  FILE **result; // rax

  if ( !byte_4042C8 )
  {
    result = sub_4010F0();
    byte_4042C8 = 1;
  }
  return result;
}

__int64 __fastcall main(int a1, char **a2, char **a3)
{
  char *v3; // rax
  void ******************v4; // rbx
  _QWORD *v6; // [rsp+0h] [rbp-68h] BYREF
  __int64 v7; // [rsp+8h] [rbp-60h] BYREF
  char s[72]; // [rsp+10h] [rbp-58h] BYREF
  unsigned __int64 v9; // [rsp+58h] [rbp-10h]

  v9 = __readfsqword(0x28u);
  printf("The cultists look expectantly to you - who will you link hands with? ");
  fgets(s, 64, stdin);
  v3 = strchr(s, 10);
  if ( v3 )
    *v3 = 0;
  if ( (unsigned int)__isoc99_sscanf(s, "%p %p", &v6, &v7) == 2 )
  {
    *v6 = v7;
    v4 = &off_404190;
    do
    {
      putchar(*((char *)v4 + 8));
      v4 = (void ******************)*v4;
    }
    while ( v4 );
    putc(10, stdout);
    return 0LL;
  }
  else
  {
    puts("You fail to grasp their hands - they look at you with suspicious...");
    return 1LL;
  }
}

```

it looks like its trying to read the value at 404190, and reading a single char for each 8 bytes in memory
I see that in other disassemblers, the base offset of 404190 seems to be consistent.

I see what it does to print the flag, from the code:

``` flag code
    do {
      putchar((int)*(char *)(ppuVar4 + 1));
      ppuVar4 = (undefined **)*ppuVar4;
    } while (ppuVar4 != (undefined **)0x0);
```

so basically, it gets ppuVar4 and prints out the character at the next `(char *)` == 8 bytes after, but the dereferences the memory address of the next ppuVar4 from that section:

i.e here at 404190, the next address is in the first 3 bytes, and the character chr(48) is 8 bytes from there:
``` 404190

        00404190 a0 41 40        addr       PTR_PTR_004041a0                                 = 004041b0
                 00 00 00 
                 00 00
                             DAT_00404198                                    XREF[1]:     FUN_00401196:0040121b(R)  
        00404198 48              undefined1 48h
        00404199 00              ??         00h
        0040419a 00              ??         00h
        0040419b 00              ??         00h
        0040419c 00              ??         00h
        0040419d 00              ??         00h
        0040419e 00              ??         00h
        0040419f 00              ??         00h
```

Looking at this area of the binary, it seems like it might be missing the first letter or two, but there are a series of letters including B{ towards the beginning, so it looks like the raw flag:

was able to pull it out by copy pasting this section in ghidra to a file and parsing:

``` ghidra
 i                            PTR_PTR_00404190                                XREF[2]:     FUN_00401196:00401214(*), 
                                                                                          FUN_00401196:00401224(R)  
        00404190 a0 41 40        addr       PTR_PTR_004041a0                                 = 004041b0
                 00 00 00 
                 00 00
                             DAT_00404198                                    XREF[1]:     FUN_00401196:0040121b(R)  
        00404198 48              undefined1 48h
        00404199 00              ??         00h
        0040419a 00              ??         00h
        0040419b 00              ??         00h
        0040419c 00              ??         00h
        0040419d 00              ??         00h
        0040419e 00              ??         00h
        0040419f 00              ??         00h
                             PTR_PTR_004041a0                                XREF[1]:     00404190(*)  
        004041a0 b0 41 40        addr       PTR_PTR_004041b0                                 = 004041c0
                 00 00 00 
                 00 00
                             DAT_004041a8                                    XREF[1]:     FUN_00401196:0040121b(R)  
        004041a8 54              undefined1 54h
        004041a9 00              ??         00h
        004041aa 00              ??         00h
        004041ab 00              ??         00h
        004041ac 00              ??         00h
        004041ad 00              ??         00h
        004041ae 00              ??         00h
        004041af 00              ??         00h
                             PTR_PTR_004041b0                                XREF[1]:     004041a0(*)  
        004041b0 c0 41 40        addr       PTR_PTR_004041c0                                 = 004041d0
                 00 00 00 
                 00 00
        004041b8 42              ??         42h    B
        004041b9 00              ??         00h
        004041ba 00              ??         00h
        004041bb 00              ??         00h
        004041bc 00              ??         00h
        004041bd 00              ??         00h
        004041be 00              ??         00h
        004041bf 00              ??         00h
                             PTR_PTR_004041c0                                XREF[1]:     004041b0(*)  
        004041c0 d0 41 40        addr       PTR_PTR_004041d0                                 = 004041e0
                 00 00 00 
                 00 00
        004041c8 7b              ??         7Bh    {
        004041c9 00              ??         00h
        004041ca 00              ??         00h
        004041cb 00              ??         00h
        004041cc 00              ??         00h
        004041cd 00              ??         00h
        004041ce 00              ??         00h
        004041cf 00              ??         00h
                             PTR_PTR_004041d0                                XREF[1]:     004041c0(*)  
        004041d0 e0 41 40        addr       PTR_PTR_004041e0                                 = 004041f0
                 00 00 00 
                 00 00
        004041d8 34              ??         34h    4
        004041d9 00              ??         00h
        004041da 00              ??         00h
        004041db 00              ??         00h
        004041dc 00              ??         00h
        004041dd 00              ??         00h
        004041de 00              ??         00h
        004041df 00              ??         00h
                             PTR_PTR_004041e0                                XREF[1]:     004041d0(*)  
        004041e0 f0 41 40        addr       PTR_PTR_004041f0                                 = 00404200
                 00 00 00 
                 00 00
        004041e8 5f              ??         5Fh    _
        004041e9 00              ??         00h
        004041ea 00              ??         00h
        004041eb 00              ??         00h
        004041ec 00              ??         00h
        004041ed 00              ??         00h
        004041ee 00              ??         00h
        004041ef 00              ??         00h
                             PTR_PTR_004041f0                                XREF[1]:     004041e0(*)  
        004041f0 00 42 40        addr       PTR_PTR_00404200                                 = 00404210
                 00 00 00 
                 00 00
        004041f8 62              ??         62h    b
        004041f9 00              ??         00h
        004041fa 00              ??         00h
        004041fb 00              ??         00h
        004041fc 00              ??         00h
        004041fd 00              ??         00h
        004041fe 00              ??         00h
        004041ff 00              ??         00h
                             PTR_PTR_00404200                                XREF[1]:     004041f0(*)  
        00404200 10 42 40        addr       PTR_PTR_00404210                                 = 00404220
                 00 00 00 
                 00 00
        00404208 72              ??         72h    r
        00404209 00              ??         00h
        0040420a 00              ??         00h
        0040420b 00              ??         00h
        0040420c 00              ??         00h
        0040420d 00              ??         00h
        0040420e 00              ??         00h
        0040420f 00              ??         00h
                             PTR_PTR_00404210                                XREF[1]:     00404200(*)  
        00404210 20 42 40        addr       PTR_PTR_00404220                                 = 00404230
                 00 00 00 
                 00 00
        00404218 33              ??         33h    3
        00404219 00              ??         00h
        0040421a 00              ??         00h
        0040421b 00              ??         00h
        0040421c 00              ??         00h
        0040421d 00              ??         00h
        0040421e 00              ??         00h
        0040421f 00              ??         00h
                             PTR_PTR_00404220                                XREF[1]:     00404210(*)  
        00404220 30 42 40        addr       PTR_PTR_00404230                                 = 00404240
                 00 00 00 
                 00 00
        00404228 34              ??         34h    4
        00404229 00              ??         00h
        0040422a 00              ??         00h
        0040422b 00              ??         00h
        0040422c 00              ??         00h
        0040422d 00              ??         00h
        0040422e 00              ??         00h
        0040422f 00              ??         00h
                             PTR_PTR_00404230                                XREF[1]:     00404220(*)  
        00404230 40 42 40        addr       PTR_PTR_00404240                                 = 00404250
                 00 00 00 
                 00 00
        00404238 6b              ??         6Bh    k
        00404239 00              ??         00h
        0040423a 00              ??         00h
        0040423b 00              ??         00h
        0040423c 00              ??         00h
        0040423d 00              ??         00h
        0040423e 00              ??         00h
        0040423f 00              ??         00h
                             PTR_PTR_00404240                                XREF[1]:     00404230(*)  
        00404240 50 42 40        addr       PTR_PTR_00404250                                 = 00404260
                 00 00 00 
                 00 00
        00404248 5f              ??         5Fh    _
        00404249 00              ??         00h
        0040424a 00              ??         00h
        0040424b 00              ??         00h
        0040424c 00              ??         00h
        0040424d 00              ??         00h
        0040424e 00              ??         00h
        0040424f 00              ??         00h
                             PTR_PTR_00404250                                XREF[1]:     00404240(*)  
        00404250 60 42 40        addr       PTR_PTR_00404260                                 = 00404270
                 00 00 00 
                 00 00
        00404258 31              ??         31h    1
        00404259 00              ??         00h
        0040425a 00              ??         00h
        0040425b 00              ??         00h
        0040425c 00              ??         00h
        0040425d 00              ??         00h
        0040425e 00              ??         00h
        0040425f 00              ??         00h
                             PTR_PTR_00404260                                XREF[1]:     00404250(*)  
        00404260 70 42 40        addr       PTR_PTR_00404270                                 = 00404280
                 00 00 00 
                 00 00
        00404268 6e              ??         6Eh    n
        00404269 00              ??         00h
        0040426a 00              ??         00h
        0040426b 00              ??         00h
        0040426c 00              ??         00h
        0040426d 00              ??         00h
        0040426e 00              ??         00h
        0040426f 00              ??         00h
                             PTR_PTR_00404270                                XREF[1]:     00404260(*)  
        00404270 80 42 40        addr       PTR_PTR_00404280                                 = 00404290
                 00 00 00 
                 00 00
        00404278 5f              ??         5Fh    _
        00404279 00              ??         00h
        0040427a 00              ??         00h
        0040427b 00              ??         00h
        0040427c 00              ??         00h
        0040427d 00              ??         00h
        0040427e 00              ??         00h
        0040427f 00              ??         00h
                             PTR_PTR_00404280                                XREF[1]:     00404270(*)  
        00404280 90 42 40        addr       PTR_PTR_DAT_00404290                             = 004042a0
                 00 00 00 
                 00 00
        00404288 74              ??         74h    t
        00404289 00              ??         00h
        0040428a 00              ??         00h
        0040428b 00              ??         00h
        0040428c 00              ??         00h
        0040428d 00              ??         00h
        0040428e 00              ??         00h
        0040428f 00              ??         00h
                             PTR_PTR_DAT_00404290                            XREF[1]:     00404280(*)  
        00404290 a0 42 40        addr       PTR_DAT_004042a0                                 = 00404060
                 00 00 00 
                 00 00
        00404298 68              ??         68h    h
        00404299 00              ??         00h
        0040429a 00              ??         00h
        0040429b 00              ??         00h
        0040429c 00              ??         00h
        0040429d 00              ??         00h
        0040429e 00              ??         00h
        0040429f 00              ??         00h
                             PTR_DAT_004042a0                                XREF[1]:     00404290(*)  
        004042a0 60 40 40        addr       DAT_00404060
                 00 00 00 
                 00 00
        004042a8 33              ??         33h    3
        004042a9 00              ??         00h
        004042aa 00              ??         00h
        004042ab 00              ??         00h
        004042ac 00              ??         00h
        004042ad 00              ??         00h
        004042ae 00              ??         00h
        004042af 00              ??         00h

```

looks like it should break off to address 404060 at this point.

then ran this quick command on the output to try to isolate the letters from this output, but did not get the whole thing:

``` shell
└──╼ $cat flag | grep 004 | awk '{print $5}' | grep -v addr | tr -d '\n'
B{4_br34k_1n_th3
```

Looked a bit earlier and it looks like maybe the first part of the flag, with some other junk data thrown in??

``` ghidra 2
                             DAT_00404060                                    XREF[1]:     004042a0(*)  
        00404060 00              ??         00h
        00404061 00              ??         00h
        00404062 00              ??         00h
        00404063 00              ??         00h
        00404064 00              ??         00h
        00404065 00              ??         00h
        00404066 00              ??         00h
        00404067 00              ??         00h
        00404068 5f              ??         5Fh    _
        00404069 00              ??         00h
        0040406a 00              ??         00h
        0040406b 00              ??         00h
        0040406c 00              ??         00h
        0040406d 00              ??         00h
        0040406e 00              ??         00h
        0040406f 00              ??         00h
        00404070 80              ??         80h                                              ?  ->  00404080
        00404071 40              ??         40h    @
        00404072 40              ??         40h    @
        00404073 00              ??         00h
        00404074 00              ??         00h
        00404075 00              ??         00h
        00404076 00              ??         00h
        00404077 00              ??         00h
        00404078 63              ??         63h    c
        00404079 00              ??         00h
        0040407a 00              ??         00h
        0040407b 00              ??         00h
        0040407c 00              ??         00h
        0040407d 00              ??         00h
        0040407e 00              ??         00h
        0040407f 00              ??         00h
        00404080 90              ??         90h                                              ?  ->  00404090
        00404081 40              ??         40h    @
        00404082 40              ??         40h    @
        00404083 00              ??         00h
        00404084 00              ??         00h
        00404085 00              ??         00h
        00404086 00              ??         00h
        00404087 00              ??         00h
        00404088 68              ??         68h    h
        00404089 00              ??         00h
        0040408a 00              ??         00h
        0040408b 00              ??         00h
        0040408c 00              ??         00h
        0040408d 00              ??         00h
        0040408e 00              ??         00h
        0040408f 00              ??         00h
        00404090 a0              ??         A0h                                              ?  ->  004040a0
        00404091 40              ??         40h    @
        00404092 40              ??         40h    @
        00404093 00              ??         00h
        00404094 00              ??         00h
        00404095 00              ??         00h
        00404096 00              ??         00h
        00404097 00              ??         00h
        00404098 34              ??         34h    4
        00404099 00              ??         00h
        0040409a 00              ??         00h
        0040409b 00              ??         00h
        0040409c 00              ??         00h
        0040409d 00              ??         00h
        0040409e 00              ??         00h
        0040409f 00              ??         00h
        004040a0 b0              ??         B0h                                              ?  ->  004040b0
        004040a1 40              ??         40h    @
        004040a2 40              ??         40h    @
        004040a3 00              ??         00h
        004040a4 00              ??         00h
        004040a5 00              ??         00h
        004040a6 00              ??         00h
        004040a7 00              ??         00h
        004040a8 31              ??         31h    1
        004040a9 00              ??         00h
        004040aa 00              ??         00h
        004040ab 00              ??         00h
        004040ac 00              ??         00h
        004040ad 00              ??         00h
        004040ae 00              ??         00h
        004040af 00              ??         00h
        004040b0 c0              ??         C0h                                              ?  ->  004040c0
        004040b1 40              ??         40h    @
        004040b2 40              ??         40h    @
        004040b3 00              ??         00h
        004040b4 00              ??         00h
        004040b5 00              ??         00h
        004040b6 00              ??         00h
        004040b7 00              ??         00h
        004040b8 6e              ??         6Eh    n
        004040b9 00              ??         00h
        004040ba 00              ??         00h
        004040bb 00              ??         00h
        004040bc 00              ??         00h
        004040bd 00              ??         00h
        004040be 00              ??         00h
        004040bf 00              ??         00h
        004040c0 d0              ??         D0h                                              ?  ->  004040d0
        004040c1 40              ??         40h    @
        004040c2 40              ??         40h    @
        004040c3 00              ??         00h
        004040c4 00              ??         00h
        004040c5 00              ??         00h
        004040c6 00              ??         00h
        004040c7 00              ??         00h
        004040c8 5f              ??         5Fh    _
        004040c9 00              ??         00h
        004040ca 00              ??         00h
        004040cb 00              ??         00h
        004040cc 00              ??         00h
        004040cd 00              ??         00h
        004040ce 00              ??         00h
        004040cf 00              ??         00h
        004040d0 e0              ??         E0h                                              ?  ->  004040e0
        004040d1 40              ??         40h    @
        004040d2 40              ??         40h    @
        004040d3 00              ??         00h
        004040d4 00              ??         00h
        004040d5 00              ??         00h
        004040d6 00              ??         00h
        004040d7 00              ??         00h
        004040d8 30              ??         30h    0
        004040d9 00              ??         00h
        004040da 00              ??         00h
        004040db 00              ??         00h
        004040dc 00              ??         00h
        004040dd 00              ??         00h
        004040de 00              ??         00h
        004040df 00              ??         00h
        004040e0 f0              ??         F0h                                              ?  ->  004040f0
        004040e1 40              ??         40h    @
        004040e2 40              ??         40h    @
        004040e3 00              ??         00h
        004040e4 00              ??         00h
        004040e5 00              ??         00h
        004040e6 00              ??         00h
        004040e7 00              ??         00h
        004040e8 65              ??         65h    e
        004040e9 00              ??         00h
        004040ea 00              ??         00h
        004040eb 00              ??         00h
        004040ec 00              ??         00h
        004040ed 00              ??         00h
        004040ee 00              ??         00h
        004040ef 00              ??         00h
        004040f0 00              ??         00h                                              ?  ->  00404100
        004040f1 41              ??         41h    A
        004040f2 40              ??         40h    @
        004040f3 00              ??         00h
        004040f4 00              ??         00h
        004040f5 00              ??         00h
        004040f6 00              ??         00h
        004040f7 00              ??         00h
        004040f8 33              ??         33h    3
        004040f9 00              ??         00h
        004040fa 00              ??         00h
        004040fb 00              ??         00h
        004040fc 00              ??         00h
        004040fd 00              ??         00h
        004040fe 00              ??         00h
        004040ff 00              ??         00h
        00404100 10              ??         10h                                              ?  ->  00404110
        00404101 41              ??         41h    A
        00404102 40              ??         40h    @
        00404103 00              ??         00h
        00404104 00              ??         00h
        00404105 00              ??         00h
        00404106 00              ??         00h
        00404107 00              ??         00h
        00404108 34              ??         34h    4
        00404109 00              ??         00h
        0040410a 00              ??         00h
        0040410b 00              ??         00h
        0040410c 00              ??         00h
        0040410d 00              ??         00h
        0040410e 00              ??         00h
        0040410f 00              ??         00h
        00404110 20              ??         20h                                              ?  ->  00404120
        00404111 41              ??         41h    A
        00404112 40              ??         40h    @
        00404113 00              ??         00h
        00404114 00              ??         00h
        00404115 00              ??         00h
        00404116 00              ??         00h
        00404117 00              ??         00h
        00404118 33              ??         33h    3
        00404119 00              ??         00h
        0040411a 00              ??         00h
        0040411b 00              ??         00h
        0040411c 00              ??         00h
        0040411d 00              ??         00h
        0040411e 00              ??         00h
        0040411f 00              ??         00h
        00404120 30              ??         30h    0                                         ?  ->  00404130
        00404121 41              ??         41h    A
        00404122 40              ??         40h    @
        00404123 00              ??         00h
        00404124 00              ??         00h
        00404125 00              ??         00h
        00404126 00              ??         00h
        00404127 00              ??         00h
        00404128 66              ??         66h    f
        00404129 00              ??         00h
        0040412a 00              ??         00h
        0040412b 00              ??         00h
        0040412c 00              ??         00h
        0040412d 00              ??         00h
        0040412e 00              ??         00h
        0040412f 00              ??         00h
        00404130 40              ??         40h    @                                         ?  ->  00404140
        00404131 41              ??         41h    A
        00404132 40              ??         40h    @
        00404133 00              ??         00h
        00404134 00              ??         00h
        00404135 00              ??         00h
        00404136 00              ??         00h
        00404137 00              ??         00h
        00404138 35              ??         35h    5
        00404139 00              ??         00h
        0040413a 00              ??         00h
        0040413b 00              ??         00h
        0040413c 00              ??         00h
        0040413d 00              ??         00h
        0040413e 00              ??         00h
        0040413f 00              ??         00h
        00404140 50              ??         50h    P                                         ?  ->  00404150
        00404141 41              ??         41h    A
        00404142 40              ??         40h    @
        00404143 00              ??         00h
        00404144 00              ??         00h
        00404145 00              ??         00h
        00404146 00              ??         00h
        00404147 00              ??         00h
        00404148 33              ??         33h    3
        00404149 00              ??         00h
        0040414a 00              ??         00h
        0040414b 00              ??         00h
        0040414c 00              ??         00h
        0040414d 00              ??         00h
        0040414e 00              ??         00h
        0040414f 00              ??         00h
        00404150 60              ??         60h    `                                         ?  ->  00404160
        00404151 41              ??         41h    A
        00404152 40              ??         40h    @
        00404153 00              ??         00h
        00404154 00              ??         00h
        00404155 00              ??         00h
        00404156 00              ??         00h
        00404157 00              ??         00h
        00404158 37              ??         37h    7
        00404159 00              ??         00h
        0040415a 00              ??         00h
        0040415b 00              ??         00h
        0040415c 00              ??         00h
        0040415d 00              ??         00h
        0040415e 00              ??         00h
        0040415f 00              ??         00h
        00404160 70              ??         70h    p                                         ?  ->  00404170
        00404161 41              ??         41h    A
        00404162 40              ??         40h    @
        00404163 00              ??         00h
        00404164 00              ??         00h
        00404165 00              ??         00h
        00404166 00              ??         00h
        00404167 00              ??         00h
        00404168 65              ??         65h    e
        00404169 00              ??         00h
        0040416a 00              ??         00h
        0040416b 00              ??         00h
        0040416c 00              ??         00h
        0040416d 00              ??         00h
        0040416e 00              ??         00h
        0040416f 00              ??         00h
        00404170 80              ??         80h                                              ?  ->  00404180
        00404171 41              ??         41h    A
        00404172 40              ??         40h    @
        00404173 00              ??         00h
        00404174 00              ??         00h
        00404175 00              ??         00h
        00404176 00              ??         00h
        00404177 00              ??         00h
        00404178 62              ??         62h    b
        00404179 00              ??         00h
        0040417a 00              ??         00h
        0040417b 00              ??         00h
        0040417c 00              ??         00h
        0040417d 00              ??         00h
        0040417e 00              ??         00h
        0040417f 00              ??         00h
        00404180 50              ??         50h    P                                         ?  ->  00404050
        00404181 40              ??         40h    @
        00404182 40              ??         40h    @
        00404183 00              ??         00h
        00404184 00              ??         00h
        00404185 00              ??         00h
        00404186 00              ??         00h
        00404187 00              ??         00h
        00404188 63              ??         63h    c
        00404189 00              ??         00h
        0040418a 00              ??         00h
        0040418b 00              ??         00h
        0040418c 00              ??         00h
        0040418d 00              ??         00h
        0040418e 00              ??         00h
        0040418f 00              ??         00h
```

so the next jump will be to 404050, but lets pull this part of the flag out from the decompiled output first:

(didn't notice at first this had an extra 0 in it, caused some frustration later until I traced it back)

``` flag2
└──╼ $cat flag2 | awk '{print $5}' | grep -v addr | tr -d '`?APp@\n'

_ch41n_0e3430f537ebc
```

but it looks like this should be it:

``` 404050

        00404050 00              ??         00h
        00404051 00              ??         00h
        00404052 00              ??         00h
        00404053 00              ??         00h
        00404054 00              ??         00h
        00404055 00              ??         00h
        00404056 00              ??         00h
        00404057 00              ??         00h
        00404058 7d              ??         7Dh    }
        00404059 00              ??         00h
        0040405a 00              ??         00h
        0040405b 00              ??         00h
        0040405c 00              ??         00h
        0040405d 00              ??         00h
        0040405e 00              ??         00h
        0040405f 00              ??         00h
                             DAT_00404060                                    XREF[1]:     004042a0(*)  
        00404060 00              ??         00h
        00404061 00              ??         00h
        00404062 00              ??         00h
```

HTB{4_br34k_1n_th3_ch41n_0e343f537ebc}
