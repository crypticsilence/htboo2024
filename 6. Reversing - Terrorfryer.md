
Checked the file type and security on it:
``` file ; checksec
└──╼ $file fryer  ; echo ; pwn checksec fryer
fryer: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=c3cfff35eca84e95e72a1d9d9095208851e5c260, for GNU/Linux 4.4.0, not stripped

[*] '/home/amplex/htb/_ctf/htboo2024/rev_terrorfryer/fryer'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:       PIE enabled
```

Disassembled, IDA code here:

``` c
/* This file was generated by the Hex-Rays decompiler version 8.4.0.240320.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

//----- (00000000000011B9) ----------------------------------------------------
size_t __fastcall fryer(char *s)
{
  size_t result; // rax
  size_t v2; // r12
  size_t v3; // r14
  __int64 v4; // rbx
  unsigned __int64 v5; // rtt
  char *v6; // rdx

  if ( !init_1 )
  {
    seed_0 = 322401073;
    init_1 = 1;
  }
  result = strlen(s);
  str_len = result;
  if ( result > 1 )
  {
    str_len = result - 1;
    begin = 0LL;
    do
    {
      rand = rand_r(&seed_0);
      result = s[i];
      new = &s[(int)(begin + rand % (str_len - i))];
      s[i] = *new;
      *new = result;
      ++i;
    }
    while ( i != str_len );
  }
  return result;
}
// 4080: using guessed type int init_1;

//----- (0000000000001242) ----------------------------------------------------
int __fastcall main(int argc, const char **argv, const char **envp)
{
  char *v3; // rax
  char v5[72]; // [rsp+0h] [rbp-68h] BYREF
  unsigned __int64 v6; // [rsp+48h] [rbp-20h]

  v6 = __readfsqword(0x28u);
  setvbuf(_bss_start, 0LL, 2, 0LL);
  printf("Please enter your recipe for frying: ");
  fgets(v5, 64, stdin);
  v3 = strchr(v5, 10);
  if ( v3 )
    *v3 = 0;
  fryer(v5);
  printf("got:      `%s`\nexpected: `%s`\n", v5, "1_n3}f3br9Ty{_6_rHnf01fg_14rlbtB60tuarun0c_tr1y3");
  if ( !strcmp("1_n3}f3br9Ty{_6_rHnf01fg_14rlbtB60tuarun0c_tr1y3", v5) )
    puts("Correct recipe - enjoy your meal!");
  else
    puts("This recipe isn't right :(");
  return 0;
}

```

So, the fryer function looks to take a character and move it a random amount based on a random number mod the length of the string, and swaps those 2 characters, and does this for the length of the string.

Since the random number is seeded with a certain number, unfortunately those random numbers will be the same each time.

I tried making the random number generator in python, but this didn't work at first, so I made a stripped down one in C instead.

Since it uses the same seed, it will produce the same numbers each time.  I want to output these numbers into python code as a static array, to be imported into a script to reverse_fry the output string (chatGPT helped me create these quickly..)

Tested that it made the same numbers each time, it did:

``` c
#include <stdio.h>
#include <stdlib.h>

// Seed from decompiled code
unsigned int seed_0 = 322401073;

// Function to generate random numbers using the seed
void generate_random_numbers(size_t count) {
        printf("    rand = [\n");
    for (size_t i = 0; i < count; i++) {
        unsigned int random_num = rand_r(&seed_0);
        printf("%u, ", random_num);
    }
        printf("    ]\n");
}

int main() {
    // Generate 10 random numbers as an example
    generate_random_numbers(64);
    
    return 0;
}
```

``` random_output
    rand = [
1237294269, 100424783, 1409524165, 1660355494, 1515991883, 2108638149, 791794171, 42788616, 1020347447, 690194375, 1763158937, 1698982405, 1250599237, 1058896557, 623524530, 445435917, 1896895300, 1923327293, 444639220, 1778256274, 877918424, 180899650, 73853256, 830838776, 480060922, 1430131672, 502772027, 1038534475, 1361352767, 909600136, 1792878874, 1617801653, 506373082, 324092439, 193514975, 2143632556, 657742178, 1524142622, 1562524622, 1705006062, 89918547, 1730863192, 642576605, 132494893, 291535445, 2108807357, 246760919, 229595017, 442967871, 715773778, 603195966, 1352411585, 1199943129, 934507197, 697922292, 441800232, 1720063332, 2141201051, 1966007192, 1570127193, 1710888921, 1567209872, 381666993, 730303657,     ]

#  removed last comma manually and spaced a bit
```

solve.py spit out the flag for me after a slight edit:

``` solve.py
import random

def fryer_reverse(target):
    # Set the initial seed
    seed = 322401073
    random.seed(seed)
    
    # Create a list from the target string
    length = len(target)
    original = list(target)
    
    # Create a list to hold the current indexes
    indexes = list(range(length))

    rand = [
        1237294269, 100424783, 1409524165, 1660355494, 1515991883, 2108638149, 
        791794171, 42788616, 1020347447, 690194375, 1763158937, 1698982405, 
        1250599237, 1058896557, 623524530, 445435917, 1896895300, 1923327293, 
        444639220, 1778256274, 877918424, 180899650, 73853256, 830838776, 
        480060922, 1430131672, 502772027, 1038534475, 1361352767, 909600136, 
        1792878874, 1617801653, 506373082, 324092439, 193514975, 2143632556, 
        657742178, 1524142622, 1562524622, 1705006062, 89918547, 1730863192, 
        642576605, 132494893, 291535445, 2108807357, 246760919, 229595017, 
        442967871, 715773778, 603195966, 1352411585, 1199943129, 934507197, 
        697922292, 441800232, 1720063332, 2141201051, 1966007192, 1570127193, 
        1710888921, 1567209872, 381666993, 730303657
    ]
    
    # Simulate the shuffling process
    for v4 in range(0,length):
        rand_value = rand[v4]  # use them in reverse
        swap_index = v4 + (rand_value % (length - v4))

        # Swap the indexes
        indexes[v4], indexes[swap_index] = indexes[swap_index], indexes[v4]

    # Create a new string to hold the original characters
    reversed_string = [''] * length

    # Place characters in their original positions
    for i in range(length):
        reversed_string[indexes[i]] = original[i]

    return ''.join(reversed_string)

# The target string that needs to be matched
target_string = "1_n3}f3br9Ty{_6_rHnf01fg_14rlbtB60tuarun0c_tr1y3"
original_string = fryer_reverse(target_string)

print(f"Original string to input: {original_string}")
```

``` output
└──╼ $pico solve.py ; python3 ./solve.py
Original string to input: HTB{4_truly_t3rr0r_fry1ng_funct10n_9b3ab6360f11}
```
